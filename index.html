<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cerium | The Athletic Standard for Roblox Sports</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        :root {
            --color-background: #050505;
            --color-heading: #FFFFFF;
            --color-text: #E0E0E0;
            --color-card-bg: rgba(255, 255, 255, 0.05);
            --color-card-border: rgba(255, 255, 255, 0.1);
            --color-card-border-hover: rgba(255, 255, 255, 0.2);
            --primary-gradient: linear-gradient(90deg, #FFFFFF, #888888);
            --color-glow: rgba(255, 255, 255, 0.3);
            --color-status-up: #00FF7F;
            --color-status-down: #FF3366;
            --color-status-caution: #FFD700;
            --header-height: 80px;
            --font-family: 'Inter', sans-serif;
            --border-radius: 16px;
            --transition-speed: 0.4s;
            --transition-curve: cubic-bezier(0.16, 1, 0.3, 1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; scroll-padding-top: var(--header-height); }
        body {
            font-family: var(--font-family); background-color: var(--color-background); color: var(--color-text);
            line-height: 1.7; overflow-x: hidden;
            background-image: radial-gradient(circle at 20% 20%, rgba(255, 255, 255, 0.04), transparent 35%), radial-gradient(circle at 80% 70%, rgba(255, 255, 255, 0.04), transparent 35%);
            position: relative;
        }
        body.no-scroll { overflow: hidden; }
        body::before { content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background-image: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 80" width="80" height="80"%3E%3Crect fill="%23050505" width="80" height="80"%3E%3C/rect%3E%3Cg fill-opacity="0.1"%3E%3Ccircle fill="%23FFFFFF" cx="40" cy="40" r="5"%3E%3C/circle%3E%3C/g%3E%3C/svg%3E'); background-size: 50px 50px; opacity: 0.05; z-index: -2; animation: pan-background 60s linear infinite; }

        /* --- Animations --- */
        @keyframes pan-background { from { background-position: 0% 0%; } to { background-position: 100% 100%; } }
        @keyframes pulse-status { 0% { box-shadow: 0 0 0 0 rgba(0, 255, 127, 0.6); } 70% { box-shadow: 0 0 0 12px transparent; } 100% { box-shadow: 0 0 0 0 transparent; } }
        @keyframes preloader-pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.1); opacity: 0.8; } }
        @keyframes hero-core-spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes btn-shine { to { transform: translateX(120%) skewX(-25deg); } }
        @keyframes reveal-up { from { opacity: 0; transform: translateY(50px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
        @keyframes fade-in { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fade-out { from { opacity: 1; } to { opacity: 0; } }
        @keyframes slide-up-and-fade-out { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-50px); } }
        @keyframes modal-fade-in { from { opacity: 0; transform: translateY(-20px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
        @keyframes skeleton-loading { 0% { background-position: -200px 0; } 100% { background-position: calc(200px + 100%) 0; } }

        /* --- Global Elements & States --- */
        #preloader, #login-wall, #welcome-transition { display: flex; align-items: center; justify-content: center; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 10000; background-color: var(--color-background); transition: opacity 0.5s ease, visibility 0.5s ease; }
        #login-wall, #welcome-transition, #main-content { opacity: 0; visibility: hidden; }
        body.state-preloading #preloader { opacity: 1; visibility: visible; }
        body.state-login #login-wall { opacity: 1; visibility: visible; animation: fade-in 0.5s ease forwards; }
        body.state-welcome #welcome-transition { opacity: 1; visibility: visible; animation: fade-in 0.5s ease forwards; }
        body.state-authenticated #main-content { opacity: 1; visibility: visible; animation: fade-in 0.5s ease forwards; }
        #preloader.hidden { opacity: 0; visibility: hidden; }

        /* --- Preloader, Login, Welcome --- */
        #preloader .preloader-logo { font-size: 2.5rem; font-weight: 800; color: var(--color-heading); animation: preloader-pulse 2s infinite ease-in-out; }
        #login-wall .login-container { text-align: center; max-width: 500px; padding: 20px; }
        #login-wall .login-card { padding: 50px 60px; animation: reveal-up 1s var(--transition-curve) 0.3s forwards; opacity: 0; }
        #login-wall .login-logo { font-size: 3rem; font-weight: 800; margin-bottom: 10px; }
        #login-wall .section-subtitle { margin-bottom: 40px; }
        #discord-login-btn { font-size: 1.1rem; padding: 16px 36px; }
        #discord-login-btn i { margin-right: 12px; }
        #welcome-transition.exiting { animation: slide-up-and-fade-out 0.8s var(--transition-curve) forwards; }
        .welcome-message { text-align: center; }
        .welcome-message h2 { font-size: 3rem; color: var(--color-heading); }
        .welcome-message .username { background: var(--primary-gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }

        /* --- Profile Modal & Achievements --- */
        #profile-modal { display: none; position: fixed; z-index: 10001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.8); backdrop-filter: blur(8px); }
        #profile-modal.visible { display: flex; align-items: center; justify-content: center; animation: fade-in 0.3s ease; }
        .profile-modal-content { background: var(--color-background); border: 1px solid var(--color-card-border); padding: 40px; border-radius: var(--border-radius); max-width: 800px; width: 90%; position: relative; animation: modal-fade-in 0.5s var(--transition-curve); }
        .profile-modal-close { color: var(--color-text); float: right; font-size: 28px; font-weight: bold; position: absolute; top: 15px; right: 25px; transition: color 0.3s; cursor: pointer; }
        .profile-modal-close:hover, .profile-modal-close:focus { color: var(--color-heading); outline: none; }
        .profile-header { display: flex; align-items: center; gap: 20px; margin-bottom: 30px; }
        #profile-modal-avatar { width: 80px; height: 80px; border-radius: 50%; }
        #profile-modal-username { font-size: 2rem; font-weight: 700; color: var(--color-heading); }
        .profile-stats { display: flex; gap: 40px; margin-bottom: 40px; padding-bottom: 20px; border-bottom: 1px solid var(--color-card-border); }
        .stat-item h4 { font-size: 0.9rem; color: var(--color-text); opacity: 0.7; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px; }
        .stat-item p { font-size: 1.2rem; font-weight: 600; color: var(--color-heading); }
        #achievements-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px; }
        .achievement-card { background: var(--color-card-bg); padding: 20px; border-radius: 12px; text-align: center; transition: all 0.3s ease; border: 1px solid var(--color-card-border); position: relative; }
        .achievement-card.locked { opacity: 0.4; filter: grayscale(80%); }
        .achievement-card.unlocked { transform: scale(1.0); }
        .achievement-card .icon { font-size: 2.5rem; margin-bottom: 15px; }
        .achievement-card.unlocked .icon { background: var(--primary-gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
        .achievement-card h5 { font-size: 1rem; color: var(--color-heading); margin-bottom: 5px; }
        .achievement-card p { font-size: 0.85rem; color: var(--color-text); opacity: 0.7; line-height: 1.4; }
        .new-badge { position: absolute; top: 10px; right: 10px; background-color: var(--color-status-up); color: black; font-size: 0.7rem; font-weight: 700; padding: 2px 8px; border-radius: 10px; }

        /* --- General UI --- */
        #cursor-glow { position: fixed; top: 0; left: 0; width: 600px; height: 600px; background: radial-gradient(circle, var(--color-glow) 0%, transparent 70%); border-radius: 50%; pointer-events: none; transform: translate(-50%, -50%); z-index: -1; transition: transform 0.2s ease-out, width 0.3s ease, height 0.3s ease; }
        #cursor-glow.clicking { width: 550px; height: 550px; }
        @media (pointer: coarse) { #cursor-glow { display: none; } }
        .btn { position: relative; display: inline-block; padding: 14px 32px; border-radius: 50px; text-decoration: none; font-weight: 600; transition: all var(--transition-speed) var(--transition-curve); border: 1px solid var(--color-card-border); cursor: pointer; white-space: nowrap; overflow: hidden; backdrop-filter: blur(5px); }
        .btn-primary { background-image: var(--primary-gradient); color: #000; border-color: transparent; box-shadow: 0 8px 30px -10px var(--color-glow); }
        .btn-primary:hover { transform: translateY(-4px) scale(1.05); box-shadow: 0 12px 35px -8px var(--color-glow); }
        .btn-primary::before { content: ''; position: absolute; top: 0; left: -100%; width: 75%; height: 100%; transform: skewX(-25deg); background: linear-gradient(to right, transparent 0%, rgba(255,255,255,0.7) 50%, transparent 100%); animation: btn-shine 1s ease-in-out 2.5s infinite; }
        .btn-secondary { background-color: transparent; color: var(--color-heading); border-color: var(--color-heading); }
        .btn-secondary:hover { background-color: var(--color-heading); color: var(--color-background); transform: translateY(-4px) scale(1.05); box-shadow: 0 0 15px -5px var(--color-heading); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none !important; box-shadow: none !important; }
        .content-section { padding: 140px 5%; max-width: 1280px; margin: 0 auto; text-align: center; }
        .section-title { font-size: 3.5rem; font-weight: 800; color: var(--color-heading); margin-bottom: 20px; line-height: 1.2; letter-spacing: -0.02em; }
        .section-subtitle { font-size: 1.1rem; max-width: 700px; margin: 0 auto 80px auto; color: var(--color-text); }
        .gradient-text { background: var(--primary-gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; }
        .card { background: var(--color-card-bg); border-radius: var(--border-radius); padding: 40px; backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border: 1px solid var(--color-card-border); transform-style: preserve-3d; transition: transform 0.6s var(--transition-curve), box-shadow 0.6s var(--transition-curve); }
        .reveal-container { opacity: 0; transition: opacity 0.8s ease; }
        .reveal-container.is-visible { opacity: 1; }
        .reveal-child { opacity: 0; transform: translateY(40px) scale(0.98); transition: opacity 0.8s var(--transition-curve), transform 0.8s var(--transition-curve); transition-delay: calc(var(--i) * 100ms); }
        .reveal-container.is-visible .reveal-child { opacity: 1; transform: translateY(0) scale(1); }
        
        /* --- Header & Navigation --- */
        .main-header { position: fixed; top: 0; left: 0; width: 100%; z-index: 1000; transition: background-color 0.3s ease, border-bottom-color 0.3s ease; height: var(--header-height); display: flex; align-items: center; border-bottom: 1px solid transparent; }
        .main-header.scrolled { background: rgba(5, 5, 5, 0.8); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border-bottom-color: var(--color-card-border); }
        .navbar { display: flex; justify-content: space-between; align-items: center; width: 100%; max-width: 1400px; margin: 0 auto; padding: 0 5%; }
        .nav-left { display: flex; align-items: center; gap: 60px; }
        .nav-actions { display: flex; align-items: center; gap: 25px; }
        .nav-actions .user-info-details { cursor: pointer; }
        .logo-area { display: flex; align-items: center; gap: 12px; text-decoration: none; }
        .nav-logo { font-size: 1.8rem; font-weight: 800; color: var(--color-heading); text-decoration: none; }
        .nav-menu { list-style: none; display: flex; gap: 45px; align-items: center; }
        .nav-link { color: var(--color-text); text-decoration: none; font-weight: 600; transition: all 0.3s ease; position: relative; padding: 5px 0; }
        .nav-link::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 2px; background: var(--primary-gradient); transition: width 0.3s ease; }
        .nav-link:hover, .nav-link.active { color: var(--color-heading); }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }
        .title-status-dot { width: 10px; height: 10px; border-radius: 50%; }
        body.status-up .title-status-dot { background-color: var(--color-status-up); animation: pulse-status 2s infinite; }

        /* --- Hero Section --- */
        .hero-section { min-height: 100vh; display: flex; align-items: center; justify-content: center; text-align: center; padding: var(--header-height) 5% 0; position: relative; overflow: hidden; }
        .hero-visual { position: absolute; top: 50%; left: 50%; width: 700px; height: 700px; transform: translate(-50%, -50%); z-index: 0; user-select: none; pointer-events: none; }
        .hero-core { width: 100%; height: 100%; position: relative; animation: hero-core-spin 90s linear infinite; }
        .hero-core::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: 50%; background: radial-gradient(circle, transparent 0%, rgba(255,255,255, 0.03) 50%, rgba(255,255,255, 0.08) 70%, transparent 80%); animation: hero-core-spin 60s linear infinite reverse; }
        .hero-content { max-width: 900px; position: relative; z-index: 1; transition: transform 0.5s var(--transition-curve); }
        .hero-title-container { overflow: hidden; }
        .hero-title { font-size: clamp(3rem, 7vw, 5.5rem); font-weight: 800; color: var(--color-heading); line-height: 1.1; margin-bottom: 25px; transform: translateY(110%); animation: reveal-up 1s cubic-bezier(0.165, 0.84, 0.44, 1) 0.5s forwards; }
        .hero-title .gradient-text { background-size: 200% auto; transition: background-position 0.5s ease; }
        .hero-title:hover .gradient-text { background-position: right center; }
        .hero-subtitle { font-size: 1.25rem; max-width: 650px; margin: 0 auto 40px; min-height: 58px; opacity: 0; animation: reveal-up 1s cubic-bezier(0.165, 0.84, 0.44, 1) 0.8s forwards; }
        .hero-buttons { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; opacity: 0; animation: reveal-up 1s cubic-bezier(0.165, 0.84, 0.44, 1) 1s forwards; }

        /* --- Games & Features --- */
        .game-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 30px; }
        .game-card { background: var(--color-card-bg); border-radius: var(--border-radius); overflow: hidden; text-align: left; transition: all 0.3s ease; border: 1px solid var(--color-card-border); }
        .game-card:hover { transform: translateY(-5px); box-shadow: 0 15px 30px rgba(0,0,0,0.3); border-color: var(--color-card-border-hover); }
        .game-card.coming-soon { opacity: 0.6; filter: grayscale(80%); }
        .game-card-thumbnail { position: relative; }
        .game-card-thumbnail img { width: 100%; display: block; aspect-ratio: 16/9; object-fit: cover; background-color: rgba(255,255,255,0.02); }
        .coming-soon-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; font-weight: 700; color: var(--color-heading); font-size: 1.1rem; letter-spacing: 1px; backdrop-filter: blur(2px); }
        .game-card-info { padding: 20px; }
        .game-card-info h3 { color: var(--color-heading); font-size: 1.2rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .game-card-info p { color: var(--color-text); opacity: 0.7; font-size: 0.9rem; }
        .game-card-actions { padding: 0 20px 20px; display: flex; gap: 10px; }
        .game-card-actions .btn { padding: 8px 20px; font-size: 0.9rem; }
        .feature-tabs { display: flex; justify-content: center; gap: 15px; margin-bottom: 50px; flex-wrap: wrap; }
        .feature-tab-btn { background: var(--color-card-bg); border: 1px solid var(--color-card-border); color: var(--color-text); padding: 12px 24px; border-radius: 8px; cursor: pointer; font-family: var(--font-family); font-weight: 600; transition: all 0.3s; }
        .feature-tab-btn:hover { background: rgba(255,255,255,0.1); color: var(--color-heading); transform: translateY(-3px); }
        .feature-tab-btn.active { background-image: var(--primary-gradient); color: black; border-color: transparent; }
        .feature-pane { display: none; animation: reveal-up 0.5s var(--transition-curve) forwards; }
        .feature-pane.active { display: block; }

        /* --- Comments Section --- */
        .comments-section { margin-top: 80px; padding-top: 40px; border-top: 1px solid var(--color-card-border); text-align: left; }
        .comments-section h3 { font-size: 2rem; text-align: center; margin-bottom: 40px; }
        .comment-form { display: flex; gap: 15px; align-items: flex-start; margin-bottom: 40px; }
        .comment-form-avatar { width: 40px; height: 40px; border-radius: 50%; }
        .comment-form-input-wrapper { flex-grow: 1; }
        .comment-textarea { width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--color-card-border); background: var(--color-card-bg); color: var(--color-text); font-family: var(--font-family); font-size: 1rem; transition: border-color 0.3s, box-shadow 0.3s; resize: vertical; min-height: 80px; }
        .comment-textarea:focus { outline: none; border-color: var(--color-heading); box-shadow: 0 0 10px var(--color-glow); }
        .comment-form-actions { display: flex; justify-content: flex-end; margin-top: 10px; }
        .comments-list { display: flex; flex-direction: column; gap: 20px; max-height: 60vh; overflow-y: auto; padding-right: 10px; }
        .comment-card { display: flex; gap: 15px; padding: 20px; background: var(--color-card-bg); border: 1px solid var(--color-card-border); border-radius: var(--border-radius); animation: fade-in 0.5s ease; }
        .comment-avatar { width: 40px; height: 40px; border-radius: 50%; flex-shrink: 0; }
        .comment-content { flex-grow: 1; }
        .comment-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .comment-user { font-weight: 700; color: var(--color-heading); }
        .comment-time { font-size: 0.85rem; color: var(--color-text); opacity: 0.6; }
        .comment-body { line-height: 1.6; white-space: pre-wrap; word-break: break-word; }
        .comments-status, .api-status { text-align: center; padding: 40px; font-style: italic; opacity: 0.7; }
        .api-status.error { color: var(--color-status-down); opacity: 1; font-weight: 600; }
        /* Skeleton Loader for Comments */
        .skeleton-comment { display: flex; gap: 15px; padding: 20px; background: var(--color-card-bg); border: 1px solid var(--color-card-border); border-radius: var(--border-radius); }
        .skeleton-avatar { width: 40px; height: 40px; border-radius: 50%; background: rgba(255,255,255,0.1); animation: skeleton-loading 1.5s infinite linear; background-image: linear-gradient(to right, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.15) 20%, rgba(255,255,255,0.1) 40%, rgba(255,255,255,0.1) 100%); background-size: 200px 100%; }
        .skeleton-content { flex-grow: 1; }
        .skeleton-line { height: 1em; border-radius: 4px; background: rgba(255,255,255,0.1); animation: skeleton-loading 1.5s infinite linear; background-image: linear-gradient(to right, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.15) 20%, rgba(255,255,255,0.1) 40%, rgba(255,255,255,0.1) 100%); background-size: 200px 100%; }
        .skeleton-line.short { width: 30%; }
        .skeleton-line.long { width: 100%; margin-top: 10px; }

        /* --- Other Sections (Timeline, Staff, Bug Report, CTA) --- */
        .timeline-container { position: relative; max-width: 900px; margin: 0 auto; }
        .timeline-container::before { content: ''; position: absolute; width: 3px; background: var(--color-card-border); top: 0; bottom: 0; left: 24px; border-radius: 3px; }
        .timeline-item { position: relative; padding: 20px 0 40px 70px; }
        .timeline-item::before { content: ''; position: absolute; width: 18px; height: 18px; background-color: var(--color-background); border: 4px solid; border-image-slice: 1; border-image-source: var(--primary-gradient); top: 25px; left: 16px; border-radius: 50%; z-index: 1; }
        .timeline-item::after { content: ''; position: absolute; width: 25px; height: 3px; background: var(--color-card-border); top: 32px; left: 45px; z-index: 0; }
        .timeline-card { padding: 30px; text-align: left; }
        .timeline-card-header { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .timeline-card-header .icon { font-size: 1.5rem; }
        .timeline-card-header h3 { font-size: 1.5rem; color: var(--color-heading); }
        .timeline-card-header .update-date { margin-left: auto; color: var(--color-text); opacity: 0.7; font-size: 0.9rem; }
        .timeline-card ul { list-style: none; padding-left: 0; }
        .timeline-card li { margin-bottom: 8px; position: relative; padding-left: 25px; }
        .timeline-card li::before { content: '\f00c'; font-family: 'Font Awesome 6 Free'; font-weight: 900; position: absolute; left: 0; color: var(--color-status-up); }
        .staff-list { display: flex; flex-direction: column; gap: 30px; max-width: 900px; margin: 0 auto; }
        .staff-card { padding: 25px; display: grid; grid-template-columns: auto 1fr auto; gap: 25px; align-items: center; text-align: left; }
        .staff-avatar { width: 80px; height: 80px; border-radius: 50%; border: 4px solid var(--color-card-border); object-fit: cover; transition: all 0.3s ease; }
        .staff-card:hover .staff-avatar { transform: scale(1.05); border-image: var(--primary-gradient) 1; border-style: solid; box-shadow: 0 0 30px var(--color-glow); }
        .staff-info h3 { font-size: 1.5rem; color: var(--color-heading); }
        .staff-info .staff-role { background: var(--primary-gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: 700; font-size: 1rem; }
        .staff-socials a { color: var(--color-text); font-size: 1.5rem; margin-left: 15px; transition: color 0.3s ease, transform 0.3s ease; }
        .staff-socials a:hover { color: var(--color-heading); transform: translateY(-2px); }
        #bug-report-form { max-width: 700px; margin: 40px auto 0; display: flex; flex-direction: column; gap: 20px; text-align: left; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; color: var(--color-heading); }
        .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 12px 15px; border-radius: 8px; border: 1px solid var(--color-card-border); background: var(--color-card-bg); color: var(--color-text); font-family: var(--font-family); font-size: 1rem; transition: border-color 0.3s, box-shadow 0.3s; }
        .form-group .select-wrapper { position: relative; }
        .form-group select { appearance: none; -webkit-appearance: none; padding-right: 40px; }
        .form-group .select-wrapper::after { content: ''; position: absolute; top: 50%; right: 15px; width: 8px; height: 8px; border-right: 2px solid var(--color-text); border-bottom: 2px solid var(--color-text); transform: translateY(-75%) rotate(45deg); pointer-events: none; transition: border-color 0.3s; }
        .form-group .select-wrapper:hover::after { border-color: var(--color-heading); }
        .form-group input.invalid, .form-group textarea.invalid, .form-group select.invalid { border-color: var(--color-status-down) !important; box-shadow: 0 0 10px rgba(255, 51, 102, 0.3) !important; }
        .form-group input:focus, .form-group textarea:focus, .form-group select:focus { outline: none; border-color: var(--color-heading); box-shadow: 0 0 10px var(--color-glow); }
        .form-group textarea { resize: vertical; min-height: 120px; }
        #form-status-message { margin-top: 20px; font-weight: 600; text-align: center; min-height: 1.2em; }
        #form-status-message.success { color: var(--color-status-up); }
        #form-status-message.error { color: var(--color-status-down); }
        #submit-bug-report:disabled { opacity: 0.7; cursor: not-allowed; }
        .user-info-details { display: flex; align-items: center; gap: 15px; }
        .user-avatar { width: 40px; height: 40px; border-radius: 50%; }
        .user-name { font-weight: 600; color: var(--color-heading); }
        #cta-section { padding: 120px 5%; background: transparent; }
        #cta-section h2 { font-size: 3rem; margin-bottom: 20px; }
        .back-to-top { position: fixed; bottom: 30px; right: 30px; width: 50px; height: 50px; background-image: var(--primary-gradient); color: #000; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; text-decoration: none; opacity: 0; visibility: hidden; transition: all 0.4s ease; z-index: 999; transform: translateY(20px); }
        .back-to-top.visible { opacity: 1; visibility: visible; transform: translateY(0); }

        /* --- Responsive Design --- */
        .mobile-nav-container { display: none; }
        @media (max-width: 1024px) {
            .navbar { display: flex; justify-content: space-between; }
            .nav-left .nav-menu-container { display: none; }
            .nav-actions { display: none; }
            .mobile-nav-container { display: flex; align-items: center; gap: 15px; }
            .nav-left .logo-area { gap: 0; }
            .main-header .nav-left { flex-grow: 1; }
            .nav-menu { position: fixed; top: 0; right: -100%; width: 100%; height: 100vh; flex-direction: column; justify-content: center; gap: 40px; background-color: var(--color-background); transition: right 0.4s ease-in-out; z-index: 1000; display: flex; }
            .nav-menu.active { right: 0; }
            .hamburger { display: block; z-index: 1001; cursor: pointer; padding: 10px; background: transparent; border: none; }
            .hamburger .bar { display: block; width: 25px; height: 3px; margin: 5px auto; background-color: white; transition: all 0.3s ease-in-out; border-radius: 2px; }
            .hamburger.active .bar:nth-child(2) { opacity: 0; transform: translateX(-20px); }
            .hamburger.active .bar:nth-child(1) { transform: translateY(8px) rotate(45deg); }
            .hamburger.active .bar:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }
            .hero-title { font-size: 3.2rem; } .hero-subtitle { font-size: 1.1rem; } .section-title { font-size: 2.5rem; }
            .mobile-actions { display: flex; flex-direction: column; align-items: center; gap: 20px; margin-top: 20px; }
            .timeline-container { padding-left: 0; }
            .timeline-item { padding-left: 40px; }
            .timeline-item::before { left: 8px; }
            .timeline-item::after { left: 35px; }
            .game-grid { grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); }
            .staff-card { grid-template-columns: 1fr; text-align: center; justify-items: center; gap: 15px; }
            .staff-socials { margin-top: 10px; }
            .staff-socials a { margin: 0 10px; }
        }
    </style>
</head>
<body class="state-preloading">

    <!-- Non-content Modals & Overlays -->
    <div id="preloader"><span class="preloader-logo gradient-text">Cerium</span></div>
    <div id="login-wall">
        <div class="login-container">
            <div class="login-card card">
                <h1 class="login-logo gradient-text">Cerium</h1>
                <p class="section-subtitle" style="margin-bottom: 40px;">Please connect with Discord to access the Cerium Hub.</p>
                <div id="login-status-message"></div>
                <button id="discord-login-btn" class="btn btn-primary"><i class="fab fa-discord"></i> Connect with Discord</button>
            </div>
        </div>
    </div>
    <div id="welcome-transition">
        <div class="welcome-message">
            <h2>Welcome, <span id="welcome-username" class="username"></span></h2>
        </div>
    </div>
    <div id="profile-modal" role="dialog" aria-modal="true" aria-labelledby="profile-modal-username">
        <div class="profile-modal-content">
            <button class="profile-modal-close" aria-label="Close profile modal">Ã—</button>
            <div class="profile-header">
                <img src="" alt="User Avatar" id="profile-modal-avatar">
                <h3 id="profile-modal-username"></h3>
            </div>
            <div class="profile-stats">
                <div class="stat-item"><h4>Member Since</h4><p id="profile-modal-join-date"></p></div>
                <div class="stat-item"><h4>Reports Submitted</h4><p id="profile-modal-report-count"></p></div>
                <div class="stat-item"><h4>Comments Posted</h4><p id="profile-modal-comment-count"></p></div>
            </div>
            <h3 style="margin-bottom: 20px;">Achievements</h3>
            <div id="achievements-grid"></div>
        </div>
    </div>

    <!-- Main Page Content -->
    <div id="main-content">
        <header class="main-header">
            <nav class="navbar">
                <div class="nav-left">
                    <a href="#welcome" class="logo-area">
                        <span class="nav-logo">Cerium</span>
                    </a>
                     <div class="nav-menu-container">
                        <ul class="nav-menu">
                            <li><a href="#supported-games" class="nav-link">Games</a></li>
                            <li><a href="#features" class="nav-link">Features</a></li>
                            <li><a href="#updates" class="nav-link">Updates</a></li>
                            <li><a href="#staff" class="nav-link">Team</a></li>
                            <li><a href="#bug-report" class="nav-link">Report</a></li>
                        </ul>
                    </div>
                </div>
                 <div class="mobile-nav-container">
                    <a href="#welcome" class="logo-area"><span class="title-status-dot"></span></a>
                    <button class="hamburger" aria-label="Open menu"><span class="bar"></span><span class="bar"></span><span class="bar"></span></button>
                    <ul class="nav-menu">
                        <li><a href="#supported-games" class="nav-link">Games</a></li>
                        <li><a href="#features" class="nav-link">Features</a></li>
                        <li><a href="#updates" class="nav-link">Updates</a></li>
                        <li><a href="#staff" class="nav-link">Team</a></li>
                        <li><a href="#bug-report" class="nav-link">Report a Bug</a></li>
                        <li class="mobile-actions">
                            <div id="mobile-user-info" class="user-info-details" style="gap: 10px; margin-bottom: 20px;" tabindex="0" role="button" aria-label="Open profile">
                                <img src="" alt="User Avatar" id="mobile-nav-user-avatar" class="user-avatar">
                                <span id="mobile-nav-user-name" class="user-name"></span>
                            </div>
                            <a href="https://discord.gg/qjsGU83urz" target="_blank" class="btn btn-primary">Join Discord</a>
                            <button id="discord-logout-btn-mobile" class="btn btn-secondary" style="margin-top: 10px;">Logout</button>
                        </li>
                    </ul>
                </div>
                <div class="nav-actions">
                    <div id="header-user-info" class="user-info-details" style="gap: 10px;" tabindex="0" role="button" aria-label="Open profile">
                        <img src="" alt="User Avatar" id="nav-user-avatar" class="user-avatar">
                        <span id="nav-user-name" class="user-name"></span>
                    </div>
                    <button id="discord-logout-btn-header" class="btn btn-secondary">Logout</button>
                </div>
            </nav>
        </header>

        <main>
            <section id="welcome" class="hero-section">
                <div class="hero-visual"><div class="hero-core"></div></div>
                <div class="hero-content">
                    <div class="hero-title-container"><h1 class="hero-title">The Athletic <span class="gradient-text">Standard</span></h1></div>
                    <p class="hero-subtitle">Engineered for victory across Roblox's top competitive sports games, giving you the ultimate edge.</p>
                    <div class="hero-buttons">
                        <a href="#supported-games" class="btn btn-primary">Explore Products</a>
                        <a href="#features" class="btn btn-secondary">View Features</a>
                    </div>
                </div>
            </section>

            <section id="supported-games" class="content-section">
                <h2 class="section-title reveal-container"><span class="reveal-child">Supported Games</span></h2>
                <p class="section-subtitle reveal-container"><span class="reveal-child" style="--i: 1;">Our platform is continuously updated.</span></p>
                <div class="game-grid reveal-container" data-stagger-container></div>
            </section>

            <section id="features" class="content-section">
                <h2 class="section-title reveal-container"><span class="reveal-child"><span class="gradient-text">Engineered for Dominance</span></span></h2>
                <p class="section-subtitle reveal-container"><span class="reveal-child" style="--i: 1;">Explore the feature set for each game.</span></p>
                <div class="feature-tabs reveal-container" data-stagger-container></div>
                <div id="feature-panes-container"></div>
            </section>

            <section id="updates" class="content-section">
                 <h2 class="section-title reveal-container"><span class="reveal-child"><span class="gradient-text">Development Roadmap</span></span></h2>
                <p class="section-subtitle reveal-container"><span class="reveal-child" style="--i: 1;">Committed to continuous improvement.</p>
                <div class="timeline-container reveal-container">
                    <div class="timeline-line"></div>
                    <div class="timeline-item reveal-child" style="--i: 2;">
                         <div class="timeline-card card card-glow">
                            <div class="timeline-card-header"><i class="fas fa-shield-alt icon gradient-text"></i><h3>Security & Stability</h3><span class="update-date">May 8, 2025</span></div>
                            <p>Enhanced anti-cheat bypasses and fixed minor bugs.</p>
                         </div>
                    </div>
                     <div class="timeline-item reveal-child" style="--i: 3;">
                         <div class="timeline-card card card-glow">
                            <div class="timeline-card-header"><i class="fas fa-rocket icon gradient-text"></i><h3>Initial Release</h3><span class="update-date">May 1, 2025</span></div>
                            <ul><li>Core script framework established.</li><li>Initial free script for RSS released.</li></ul>
                         </div>
                    </div>
                </div>
            </section>

            <section id="staff" class="content-section">
                <h2 class="section-title reveal-container"><span class="reveal-child"><span class="gradient-text">Meet The Team</span></span></h2>
                <p class="section-subtitle reveal-container"><span class="reveal-child" style="--i: 1;">The architects behind Cerium's success.</span></p>
                <div class="staff-list reveal-container" data-stagger-container>
                    <div class="card card-glow staff-card reveal-child" style="--i: 2;">
                        <img src="https://cdn.discordapp.com/avatars/1283596576983482441/20ec9f630f42a06fb355aecf91ac9b50.png?size=512" alt="Staff Avatar" class="staff-avatar">
                        <div class="staff-info"><h3>op_eq</h3><p class="staff-role">Owner</p></div>
                        <div class="staff-socials"><a href="#" aria-label="Discord"><i class="fab fa-discord"></i></a><a href="#" aria-label="Twitter"><i class="fab fa-twitter"></i></a></div>
                    </div>
                </div>
            </section>

            <section id="bug-report" class="content-section">
                <h2 class="section-title reveal-container"><span class="reveal-child">Report a Bug</span></h2>
                <div id="bug-report-container" class="reveal-container">
                    <div id="report-container" class="reveal-child" style="--i: 1;">
                        <form id="bug-report-form">
                            <div class="form-group">
                                <label for="game-select">Select Game</label>
                                <div class="select-wrapper"><select id="game-select" name="game-select" required></select></div>
                            </div>
                            <div class="form-group">
                                <label for="bug-description">Bug Description</label>
                                <textarea id="bug-description" name="bug-description" placeholder="Please be as detailed as possible." required></textarea>
                            </div>
                            <div>
                                <button type="submit" id="submit-bug-report" class="btn btn-primary">Submit Report</button>
                                <p id="form-status-message"></p>
                            </div>
                        </form>
                    </div>
                </div>
            </section>

            <section id="cta-section" class="content-section">
                <div class="reveal-container">
                    <h2 class="reveal-child" style="--i: 1;">Ready to Redefine Your Game?</h2>
                    <p class="section-subtitle reveal-child" style="--i: 2;">Join our community of elite players.</p>
                    <a href="https://discord.gg/qjsGU83urz" target="_blank" class="btn btn-primary btn-lg reveal-child" style="--i: 3;">Join the Discord Server</a>
                </div>
            </section>
        </main>
        <a href="#welcome" class="back-to-top" aria-label="Back to top"><i class="fas fa-arrow-up"></i></a>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", function() {
        // --- CONFIGURATION ---
        const DISCORD_CLIENT_ID = "1397805094854197280";
        const REDIRECT_URI = window.location.origin + window.location.pathname;
        const BUG_REPORT_RATE_LIMIT_MS = 60 * 60 * 1000; // 1 hour

        // --- DOM ELEMENTS ---
        const body = document.body;
        const preloader = document.getElementById('preloader');
        const welcomeTransition = document.getElementById('welcome-transition');
        const discordLoginBtn = document.getElementById('discord-login-btn');
        const bugReportForm = document.getElementById('bug-report-form');
        const profileModal = document.getElementById('profile-modal');
        const profileModalClose = document.querySelector('.profile-modal-close');
        
        // --- ACHIEVEMENT CONFIGURATION ---
        const ACHIEVEMENTS = {
            'welcome': { name: 'Welcome to the Hub', description: 'Successfully logged in.', icon: 'fas fa-door-open', condition: () => true },
            'first_report': { name: 'Bug Squasher', description: 'Submitted your first report.', icon: 'fas fa-bug', condition: (profile) => profile.reportCount >= 1 },
            'first_comment': { name: 'Community Voice', description: 'Posted your first comment.', icon: 'fas fa-comment-dots', condition: (profile) => profile.commentCount >= 1},
            'veteran': { name: 'Community Veteran', description: 'A member for over 30 days.', icon: 'fas fa-shield-alt', condition: (profile) => (Date.now() - new Date(profile.joinDate).getTime()) >= 30 * 24 * 60 * 60 * 1000 }
        };

        // --- HELPER FUNCTIONS ---
        const getProfileKey = (discordId) => `cerium_user_profile_${discordId}`;
        const getNewAchievementsKey = (discordId) => `cerium_new_achievements_${discordId}`;
        const getBugReportTimestampKey = (discordId) => `cerium_bug_report_ts_${discordId}`;
        const timeAgo = (date) => {
            const seconds = Math.floor((new Date() - new Date(date)) / 1000);
            if (seconds < 60) return "Just now";
            const intervals = { year: 31536000, month: 2592000, day: 86400, hour: 3600, minute: 60 };
            for (let unit in intervals) {
                let interval = Math.floor(seconds / intervals[unit]);
                if (interval >= 1) return `${interval} ${unit}${interval > 1 ? 's' : ''} ago`;
            }
        };
        const getCurrentUser = () => {
            try { return JSON.parse(localStorage.getItem('discord_user_v2')); } catch (e) { return null; }
        };

        // --- PROFILE & ACHIEVEMENT LOGIC ---
        function getOrCreateProfile(userData) {
            const profileKey = getProfileKey(userData.id);
            let profile = JSON.parse(localStorage.getItem(profileKey));
            if (!profile) {
                profile = { discordId: userData.id, joinDate: new Date().toISOString(), reportCount: 0, commentCount: 0, unlockedAchievements: [] };
                localStorage.setItem(profileKey, JSON.stringify(profile));
                unlockAchievement(profile, 'welcome');
            }
            return profile;
        }

        function unlockAchievement(profile, achievementId) {
            if (profile.unlockedAchievements.includes(achievementId)) return;
            profile.unlockedAchievements.push(achievementId);
            localStorage.setItem(getProfileKey(profile.discordId), JSON.stringify(profile));
            const newKey = getNewAchievementsKey(profile.discordId);
            let newAchievements = JSON.parse(sessionStorage.getItem(newKey)) || [];
            if (!newAchievements.includes(achievementId)) {
                newAchievements.push(achievementId);
                sessionStorage.setItem(newKey, JSON.stringify(newAchievements));
            }
        }

        function checkAndUnlockAchievements(profile) {
            Object.keys(ACHIEVEMENTS).forEach(id => {
                if (!profile.unlockedAchievements.includes(id) && ACHIEVEMENTS[id].condition(profile)) {
                   unlockAchievement(profile, id);
                }
            });
        }

        function displayProfileModal() {
            const userData = getCurrentUser();
            if (!userData) return;
            const profile = getOrCreateProfile(userData);
            const newKey = getNewAchievementsKey(profile.discordId);
            const newAchievements = JSON.parse(sessionStorage.getItem(newKey)) || [];
            document.getElementById('profile-modal-avatar').src = `https://cdn.discordapp.com/avatars/${userData.id}/${userData.avatar}.png`;
            document.getElementById('profile-modal-username').textContent = `${userData.username}#${userData.discriminator}`;
            document.getElementById('profile-modal-join-date').textContent = new Date(profile.joinDate).toLocaleDateString();
            document.getElementById('profile-modal-report-count').textContent = profile.reportCount;
            document.getElementById('profile-modal-comment-count').textContent = profile.commentCount || 0;
            const grid = document.getElementById('achievements-grid');
            grid.innerHTML = '';
            Object.keys(ACHIEVEMENTS).forEach(id => {
                const achievement = ACHIEVEMENTS[id];
                const isUnlocked = profile.unlockedAchievements.includes(id);
                const isNew = newAchievements.includes(id);
                grid.insertAdjacentHTML('beforeend', `
                    <div class="achievement-card ${isUnlocked ? 'unlocked' : 'locked'}" title="${achievement.description}">
                        ${isNew ? '<span class="new-badge">New!</span>' : ''}
                        <i class="icon ${achievement.icon}"></i>
                        <h5>${achievement.name}</h5>
                        <p>${achievement.description}</p>
                    </div>`);
            });
            profileModal.classList.add('visible');
            body.classList.add('no-scroll');
        }

        function closeProfileModal() {
            profileModal.classList.remove('visible');
            body.classList.remove('no-scroll');
            const userData = getCurrentUser();
            if (userData) sessionStorage.removeItem(getNewAchievementsKey(userData.id));
        }

        // --- PAGE STATE MANAGEMENT ---
        const setPageState = (state) => body.className = `state-${state}`;

        const showLoginWall = (message = null) => {
            if (message) {
                const statusMsg = document.getElementById('login-status-message');
                statusMsg.textContent = message;
                statusMsg.className = 'error';
            }
            preloader.classList.add('hidden');
            setPageState('login');
        };

        const showWelcomeTransition = async (userData) => {
            document.getElementById('welcome-username').textContent = userData.username;
            preloader.classList.add('hidden');
            setPageState('welcome');
            await loadAndDisplayGames();
            setTimeout(() => {
                welcomeTransition.classList.add('exiting');
                setTimeout(() => showMainContent(userData), 800);
            }, 2000);
        };

        const showMainContent = (userData) => {
            const profile = getOrCreateProfile(userData);
            checkAndUnlockAchievements(profile);
            setPageState('authenticated');
            body.classList.add('status-up');
            initializePageScripts(userData);
        };

        const handleLogout = () => {
            if (window.confirm("Are you sure you want to log out?")) {
                localStorage.removeItem('discord_user_v2');
                Object.keys(localStorage).forEach(key => {
                    if (key.startsWith('cerium_')) localStorage.removeItem(key);
                });
                window.location.reload();
            }
        };

        const handleOAuthCallback = async () => {
            const fragment = new URLSearchParams(window.location.hash.substring(1));
            const accessToken = fragment.get('access_token');
            const checkAndRedirect = async (user) => {
                try {
                    const res = await fetch(`/api/check-user-status?userId=${user.id}`);
                    const data = await res.json();
                    if (data.status === 'banned') window.location.href = `/banned.html?reason=${encodeURIComponent(data.reason || 'N/A')}`;
                    else if (data.status === 'suspended') window.location.href = `/suspended.html?expires=${encodeURIComponent(data.expires)}&reason=${encodeURIComponent(data.reason || 'N/A')}`;
                    else return true;
                    return false;
                } catch (e) { return true; }
            };

            if (accessToken) {
                try {
                    const res = await fetch('https://discord.com/api/users/@me', { headers: { authorization: `Bearer ${accessToken}` } });
                    if (!res.ok) throw new Error('Failed to fetch user data.');
                    const userData = await res.json();
                    if (!await checkAndRedirect(userData)) return;
                    localStorage.setItem('discord_user_v2', JSON.stringify(userData));
                    window.history.replaceState({}, document.title, window.location.pathname);
                    fetch('/api/record-login', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ user: userData }) });
                    await showWelcomeTransition(userData);
                } catch (error) {
                    showLoginWall('Login failed. Please try again.');
                    window.history.replaceState({}, document.title, window.location.pathname);
                }
            } else {
                const storedUser = getCurrentUser();
                if (storedUser) {
                    if (!await checkAndRedirect(storedUser)) return;
                    setTimeout(() => showWelcomeTransition(storedUser), 500);
                } else {
                    showLoginWall();
                }
            }
        };

        // --- CONTENT & API LOGIC ---
        async function loadAndDisplayGames() {
            const gameGrid = document.querySelector('#supported-games .game-grid');
            const featureTabs = document.querySelector('#features .feature-tabs');
            const featurePanesContainer = document.getElementById('feature-panes-container');
            const gameSelect = document.getElementById('game-select');
            
            gameGrid.innerHTML = '<p class="api-status">Loading games...</p>';
            [featureTabs, featurePanesContainer, gameSelect].forEach(el => el.innerHTML = '');
            gameSelect.innerHTML = '<option value="" disabled selected>Loading...</option>';

            try {
                const response = await fetch('/api/games');
                if (!response.ok) throw new Error((await response.json()).details || 'Server error');
                const games = await response.json();
                
                gameGrid.innerHTML = '';
                gameSelect.innerHTML = '<option value="" disabled selected>Choose a game...</option>';
                let isFirstActive = true;
                games.forEach((game, index) => {
                    const isComingSoon = game.status?.trim().toLowerCase() === 'coming soon';
                    gameGrid.insertAdjacentHTML('beforeend', `<div class="game-card ${isComingSoon ? 'coming-soon' : ''} reveal-child" style="--i: ${index + 2};"><div class="game-card-thumbnail"><img src="${game.thumbnail_url || ''}" alt="${game.name} Thumbnail" onerror="this.style.display='none'">${isComingSoon ? '<div class="coming-soon-overlay">COMING SOON</div>' : ''}</div><div class="game-card-info"><h3>${game.name}</h3><p>${game.status}</p></div><div class="game-card-actions">${isComingSoon ? '<button class="btn btn-secondary" disabled>Features</button>' : `<a href="#features" class="btn btn-primary features-trigger" data-game="${game.topic_id}">Features</a>`}</div></div>`);
                    gameSelect.insertAdjacentHTML('beforeend', `<option value="${game.name}">${game.name}</option>`);
                    if (!isComingSoon) {
                        const activeClass = isFirstActive ? 'active' : '';
                        featureTabs.insertAdjacentHTML('beforeend', `<button class="feature-tab-btn ${activeClass}" data-game="${game.topic_id}">${game.name}</button>`);
                        featurePanesContainer.insertAdjacentHTML('beforeend', `<div id="features-${game.topic_id}" class="feature-pane ${activeClass}">${game.features_html || `<div class="card"><p>Features are being documented.</p></div>`}<div class="comments-section card-glow"><h3><i class="fas fa-comments gradient-text"></i> Community Discussion</h3><form class="comment-form" data-topic="${game.topic_id}"><img src="" alt="Your avatar" class="comment-form-avatar"><div class="comment-form-input-wrapper"><textarea class="comment-textarea" placeholder="Share your thoughts..." required></textarea><div class="comment-form-actions"><button type="submit" class="btn btn-primary" style="padding: 10px 24px;">Post</button></div></div></form><div class="comments-list" id="comments-list-${game.topic_id}"></div></div></div>`);
                        isFirstActive = false;
                    }
                });
                gameSelect.insertAdjacentHTML('beforeend', `<option value="Other">Other</option>`);
            } catch (error) { gameGrid.innerHTML = `<p class="api-status error">Could not load games: ${error.message}</p>`; }
        }

        const renderComments = (comments, topicId) => {
            const list = document.getElementById(`comments-list-${topicId}`);
            if (!list) return;
            list.innerHTML = comments.length === 0 ? `<p class="comments-status">Be the first to comment!</p>` : '';
            comments.forEach(comment => list.appendChild(createCommentCard(comment)));
        };

        const createCommentCard = (comment) => {
            const card = document.createElement('div');
            card.className = 'comment-card';
            card.innerHTML = `<img src="${comment.user_avatar || 'https://cdn.discordapp.com/embed/avatars/0.png'}" alt="avatar" class="comment-avatar"><div class="comment-content"><div class="comment-header"><span class="comment-user">${comment.user_name}</span><span class="comment-time">${timeAgo(comment.created_at)}</span></div><p class="comment-body"></p></div>`;
            card.querySelector('.comment-body').textContent = comment.content;
            return card;
        };

        const showCommentSkeleton = (topicId) => {
            const list = document.getElementById(`comments-list-${topicId}`);
            if (!list) return;
            let skeletonHTML = '';
            for (let i = 0; i < 3; i++) {
                skeletonHTML += `
                    <div class="skeleton-comment">
                        <div class="skeleton-avatar"></div>
                        <div class="skeleton-content">
                            <div class="skeleton-line short"></div>
                            <div class="skeleton-line long"></div>
                        </div>
                    </div>`;
            }
            list.innerHTML = skeletonHTML;
        };
        
        const fetchComments = async (topicId) => {
            showCommentSkeleton(topicId);
            try {
                const response = await fetch(`/api/comments?topic=${topicId}`);
                if (!response.ok) throw new Error('Failed to load comments.');
                const comments = await response.json();
                setTimeout(() => renderComments(comments, topicId), 300); // Small delay for smoother transition
            } catch (error) { 
                const list = document.getElementById(`comments-list-${topicId}`);
                if (list) list.innerHTML = `<p class="comments-status error">${error.message}</p>`; 
            }
        };

        // --- PAGE INITIALIZATION & EVENT LISTENERS ---
        function initializePageScripts(userData) {
            // Update user-specific elements
            const avatarUrl = `https://cdn.discordapp.com/avatars/${userData.id}/${userData.avatar}.png`;
            const userDisplay = `${userData.username}#${userData.discriminator}`;
            document.getElementById('nav-user-avatar').src = avatarUrl;
            document.getElementById('nav-user-name').textContent = userDisplay;
            document.getElementById('mobile-nav-user-avatar').src = avatarUrl;
            document.getElementById('mobile-nav-user-name').textContent = userDisplay;
            document.querySelectorAll('.comment-form-avatar').forEach(img => img.src = avatarUrl);
            
            // UI Enhancements
            const isReducedMotion = window.matchMedia(`(prefers-reduced-motion: reduce)`).matches;
            if (!isReducedMotion && window.matchMedia('(pointer: fine)').matches) {
                const glow = document.getElementById('cursor-glow');
                document.addEventListener('mousemove', (e) => requestAnimationFrame(() => glow.style.transform = `translate(${e.clientX}px, ${e.clientY}px) translate(-50%,-50%)`));
            }
            const header = document.querySelector('.main-header');
            const backToTopButton = document.querySelector('.back-to-top');
            const sections = document.querySelectorAll('section[id]');
            const navLinks = document.querySelectorAll('.nav-menu a.nav-link');
            let scrollTimeout;

            // CORRECTED: Reading CSS variable
            const headerHeightValue = getComputedStyle(document.documentElement).getPropertyValue('--header-height');
            const headerHeight = parseInt(headerHeightValue, 10) || 80;

            const handleScroll = () => {
                header.classList.toggle('scrolled', window.scrollY > 50);
                backToTopButton.classList.toggle('visible', window.scrollY > 300);
                
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    let currentSectionId = '';
                    sections.forEach(section => {
                        const sectionTop = section.offsetTop;
                        if (window.scrollY >= sectionTop - headerHeight - 100) {
                            currentSectionId = section.getAttribute('id');
                        }
                    });

                    navLinks.forEach(link => {
                        link.classList.remove('active');
                        if (link.getAttribute('href') === `#${currentSectionId}`) {
                            link.classList.add('active');
                        }
                    });
                }, 100);
            };
            window.addEventListener('scroll', handleScroll, { passive: true });

            if (!isReducedMotion) {
                const observer = new IntersectionObserver((entries, obs) => {
                    entries.forEach(entry => { if (entry.isIntersecting) { entry.target.classList.add('is-visible'); obs.unobserve(entry.target); } });
                }, { threshold: 0.1, rootMargin: "0px 0px -50px 0px" });
                document.querySelectorAll('.reveal-container').forEach(el => observer.observe(el));
            } else { document.querySelectorAll('.reveal-container').forEach(el => el.classList.add('is-visible')); }

            // Mobile Navigation
            const hamburger = document.querySelector('.hamburger');
            const mobileNavMenu = document.querySelector('.mobile-nav-container .nav-menu');
            const toggleMenu = () => {
                const isActive = hamburger.classList.toggle('active');
                mobileNavMenu.classList.toggle('active');
                body.classList.toggle('no-scroll', isActive);
            };
            hamburger.addEventListener('click', toggleMenu);
            mobileNavMenu.querySelectorAll('a, button').forEach(el => el.addEventListener('click', () => {
                 if (hamburger.classList.contains('active')) toggleMenu(); 
            }));

            // Tab Switching Logic
            let loadedComments = [];
            function switchFeatureTab(gameId) {
                document.querySelectorAll('.feature-tab-btn').forEach(btn => btn.classList.toggle('active', btn.dataset.game === gameId));
                document.querySelectorAll('.feature-pane').forEach(pane => pane.classList.toggle('active', pane.id === `features-${gameId}`));
                if (!loadedComments.includes(gameId)) { 
                    fetchComments(gameId); 
                    loadedComments.push(gameId); 
                }
            }

            const mainContent = document.getElementById('main-content');
            mainContent.addEventListener('click', (e) => {
                const featureTabBtn = e.target.closest('.feature-tab-btn');
                if (featureTabBtn) { switchFeatureTab(featureTabBtn.dataset.game); return; }
                const featureTrigger = e.target.closest('.features-trigger:not(:disabled)');
                if (featureTrigger) {
                    e.preventDefault();
                    document.querySelector('#features').scrollIntoView({ behavior: 'smooth' });
                    switchFeatureTab(featureTrigger.dataset.game);
                }
            });

            // Initial comment load
            const activeTab = document.querySelector('.feature-tab-btn.active');
            if (activeTab) { 
                const initialGameId = activeTab.dataset.game;
                fetchComments(initialGameId); 
                loadedComments.push(initialGameId);
            }

            // Profile Modal Listeners
            document.getElementById('header-user-info').addEventListener('click', displayProfileModal);
            document.getElementById('mobile-user-info').addEventListener('click', displayProfileModal);
            profileModalClose.addEventListener('click', closeProfileModal);
            window.addEventListener('click', (event) => { if (event.target == profileModal) closeProfileModal(); });
            document.addEventListener('keydown', (e) => { if (e.key === 'Escape' && profileModal.classList.contains('visible')) closeProfileModal(); });

            // Bug Report Rate Limiting
            const reportSubmitBtn = document.getElementById('submit-bug-report');
            const reportStatusMsg = document.getElementById('form-status-message');
            const lastReportTime = parseInt(localStorage.getItem(getBugReportTimestampKey(userData.id)), 10);
            if (lastReportTime && (Date.now() - lastReportTime < BUG_REPORT_RATE_LIMIT_MS)) {
                reportSubmitBtn.disabled = true;
                const remainingTime = Math.ceil((BUG_REPORT_RATE_LIMIT_MS - (Date.now() - lastReportTime)) / (60 * 1000));
                reportStatusMsg.textContent = `You can submit another report in ${remainingTime} minute(s).`;
                reportStatusMsg.className = 'error';
            }
        }
        
        // --- FORM SUBMISSION LISTENERS ---
        bugReportForm.addEventListener('submit', async function(event) {
            event.preventDefault();
            const submitButton = document.getElementById('submit-bug-report');
            const statusMessage = document.getElementById('form-status-message');
            const gameSelect = document.getElementById('game-select');
            const bugDesc = document.getElementById('bug-description');
            
            // Client-side validation
            let isValid = true;
            [gameSelect, bugDesc].forEach(field => field.classList.remove('invalid'));
            if (!gameSelect.value) { gameSelect.classList.add('invalid'); isValid = false; }
            if (!bugDesc.value.trim()) { bugDesc.classList.add('invalid'); isValid = false; }
            if (!isValid) {
                statusMessage.textContent = 'Please fill out all required fields.';
                statusMessage.className = 'error';
                return;
            }

            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';

            const userData = getCurrentUser();
            const reportData = {
                userId: userData.id,
                username: `${userData.username}#${userData.discriminator}`,
                game: gameSelect.value,
                description: bugDesc.value.trim()
            };
            const discordPayload = {
                username: "Cerium Bug Reports",
                embeds: [{
                    author: { name: `Report by ${reportData.username}`, icon_url: `https://cdn.discordapp.com/avatars/${userData.id}/${userData.avatar}.png` },
                    fields: [{ name: "Game", value: reportData.game }, { name: "Description", value: "```" + reportData.description + "```" }],
                    timestamp: new Date().toISOString()
                }]
            };

            try {
                const response = await fetch('/api/bug-reports', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ reportData, discordPayload }) });
                if (!response.ok) throw new Error((await response.json()).error || 'Submission failed.');
                
                statusMessage.textContent = 'Report submitted successfully! Thank you.';
                statusMessage.className = 'success';
                setTimeout(() => { bugReportForm.reset(); statusMessage.textContent = ''; statusMessage.className = ''; }, 3000);
                
                const profile = getOrCreateProfile(userData);
                profile.reportCount = (profile.reportCount || 0) + 1;
                localStorage.setItem(getProfileKey(userData.id), JSON.stringify(profile));
                localStorage.setItem(getBugReportTimestampKey(userData.id), Date.now());
                checkAndUnlockAchievements(profile);
            } catch (error) {
                statusMessage.textContent = `Error: ${error.message}`;
                statusMessage.className = 'error';
                submitButton.disabled = false;
                submitButton.innerHTML = 'Submit Report';
            }
        });
        
        body.addEventListener('submit', async (e) => {
            if (!e.target.matches('.comment-form')) return;
            e.preventDefault();
            const form = e.target, submitButton = form.querySelector('button[type="submit"]'), textarea = form.querySelector('.comment-textarea');
            const content = textarea.value.trim(), topic = form.dataset.topic;
            if (!content) return;

            const originalButtonHTML = submitButton.innerHTML;
            submitButton.disabled = true;
            submitButton.innerHTML = `<i class="fas fa-spinner fa-spin"></i>`;
            
            try {
                const user = getCurrentUser();
                const response = await fetch('/api/comments', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ topic, content, user }) });
                if (!response.ok) throw new Error((await response.json()).error || 'Failed to post.');
                
                const newComment = await response.json();
                const list = document.getElementById(`comments-list-${topic}`);
                if (list.querySelector('.comments-status')) list.innerHTML = '';
                list.prepend(createCommentCard(newComment));
                textarea.value = '';

                const profile = getOrCreateProfile(user);
                profile.commentCount = (profile.commentCount || 0) + 1;
                localStorage.setItem(getProfileKey(user.id), JSON.stringify(profile));
                checkAndUnlockAchievements(profile);
            } catch (error) {
                alert(`Error: ${error.message}`);
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = originalButtonHTML;
            }
        });

        // --- GLOBAL EVENT LISTENERS & INITIALIZATION ---
        discordLoginBtn.addEventListener('click', () => window.location.href = `https://discord.com/api/oauth2/authorize?client_id=${DISCORD_CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=token&scope=identify`);
        document.getElementById('discord-logout-btn-header').addEventListener('click', handleLogout);
        document.getElementById('discord-logout-btn-mobile').addEventListener('click', handleLogout);

        handleOAuthCallback();
    });
    </script>
</body>
</html>